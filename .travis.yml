language: csharp
solution: dotnet-exec.sln
mono: none
dotnet: 3.1

jobs:
  include:
    - stage: test
      if: type = push
      script:
        - dotnet restore
        - dotnet build
        - dotnet test
    - stage: publish
      if: 
        - branch = master
        - type = push
      script:
        - dotnet restore
        - dotnet pack
        - dotnet nuget push .nupkg/*.nupkg --api-key $NUGET_API_KEY -Source $NUGET_SOURCE
